restaurants = [
 {
   name: "Pizzeria Ciepły Piecyk",
   img: "img/pizza.png",
   link: "pizzeriaCiepłyPiecyk.html",
   type: "wloska",
   desc: "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.",
   delivery: 5,
   minimalOrderValue: 30,
   clientsOpinion: 4.2
 },
 {
   name: "Szalone makarony",
   img: "img/ravioli.png",
   link: "SzaloneMakarony.html",
   type: "wloska",
   desc: "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.",
   delivery: 10,
   minimalOrderValue: 25,
   clientsOpinion: 4.5
 },
 {
   name: "Złota kura",
   img: "img/chicken.png",
   link: "ZlotaKura.html",
   type: "domowa",
   desc: "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.",
   delivery: 0,
   minimalOrderValue: 40,
   clientsOpinion: 4.7
 },
 {
   name: "Mama da",
   img: "img/soup_pl.png",
   link: "MamaDa.html",
   type: "domowa",
   desc: "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.",
   delivery: 10,
   minimalOrderValue: 35,
   clientsOpinion: 4.8
 },
 {
   name: "Bangkok",
   img: "img/bowl.png",
   link: "Bangkok.html",
   type: "azjatycka",
   desc: "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.",
   delivery: 3,
   minimalOrderValue: 25,
   clientsOpinion: 4.4
 },
 {
   name: "RamenAmen",
   img: "img/ramen.png",
   link: "RamenAmen.html",
   type: "azjatycka",
   desc: "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.",
   delivery: 0,
   minimalOrderValue: 20,
   clientsOpinion: 4.6
 },
 {
   name: "Palce lizać",
   img: "img/hamburger.png",
   link: "Palcelizac.html",
   type: "fast-food",
   desc: "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.",
   delivery: 5,
   minimalOrderValue: 25,
   clientsOpinion: 3.5
 },
 {
   name: "Trójkąty i kwadraty",
   img: "img/quesadilla.png",
   link: "TrojkatyKwadraty.html",
   type: "fast-food",
   desc: "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.",
   delivery: 10,
   minimalOrderValue: 25,
   clientsOpinion: 4.0
 },
 {
   name: "Ja Cię kręcę",
   img: "img/kebab.png",
   link: "JaCieKrece.html",
   type: "kebab",
   desc: "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.",
   delivery: 5,
   minimalOrderValue: 20,
   clientsOpinion: 4.1
 },
 {
   name: "Liczy się wnętrze",
   img: "img/kebab_doner.png",
   link: "LiczySieWnetrze.html",
   type: "kebab",
   desc: "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.",
   delivery: 3,
   minimalOrderValue: 20,
   clientsOpinion: 4.0
 },
{
   name: "The dumplings",
   img: "img/dumpling.png",
   link: "TheDumplings.html",
   type: "polska",
   desc: "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.",
   delivery: 5,
   minimalOrderValue: 35,
   clientsOpinion: 4.5
 },
{
   name: "Schabowy i mizeria",
   img: "img/chop.png",
   link: "SchabowyMizeria.html",
   type: "polska",
   desc: "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.",
   delivery: 0,
   minimalOrderValue: 25,
   clientsOpinion: 4.5
 },
 {
   name: "Zielone warzywko",
   img: "img/salad.png",
   link: "ZieloneWarzywko.html",
   type: "wegetarianska",
   desc: "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.",
   delivery: 15,
   minimalOrderValue: 30,
   clientsOpinion: 3.9
 },
 {
   name: "Bakłażan",
   img: "img/eggplant.png",
   link: "Baklazan.html",
   type: "wegetarianska",
   desc: "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.",
   delivery: 10,
   minimalOrderValue: 30,
   clientsOpinion: 4.5
 }
];






deleteItemsFromLS();
displayData = sortByDelivery();
displayData = sortByTypeOfRestaurant(displayData);
displayData = sortingResults(displayData);
displayResults(displayData);
checkIfAny(displayData);


function sortByDelivery(){
  let deliveryCost = localStorage.getItem('deliveryCost');
  var restaurantsToDisplay = [];

  if (deliveryCost == 'none'){
    for(var item of restaurants){
      restaurantsToDisplay.push(item);
    }
  }
  else {
    for (var item of restaurants){
      if (item.delivery <= parseInt(deliveryCost))
      {
        restaurantsToDisplay.push(item);
      }
    }
  }
  return restaurantsToDisplay;
}



function sortByTypeOfRestaurant(presortedData){
  if (localStorage.getItem('Type')=='wszystkie'){
    return presortedData;
  }
  else {
    let restaurantsType = localStorage.getItem('Type').split(',');
    let length = presortedData.length;
    console.log(length);
    console.log(presortedData);
    let sortedRest = []
    for (var item of restaurantsType){
      for (var element of presortedData){
        if(element.type == item){
          sortedRest.push(element);
        }
      }
    }


      console.log(sortedRest);
      return sortedRest;
  }
}

function sortingResults(data){
  let sortBy = localStorage.getItem('SortBy');
  if (sortBy == 'opinion'){
    var sortedObjs = data.sort(dynamicSort("-clientsOpinion"));
    return sortedObjs;

  }
  if(sortBy == 'cost'){
    var sortedObjs = data.sort(dynamicSort("delivery"));
    return sortedObjs;
  }
  else {
    return data;
  }
}


function dynamicSort(property) {
    var sortOrder = 1;
    if(property[0] === "-") {
        sortOrder = -1;
        property = property.substr(1);
    }
    return function (a,b) {
        var result = (a[property] < b[property]) ? -1 : (a[property] > b[property]) ? 1 : 0;
        return result * sortOrder;
    }
}

function displayResults(data) {
  let productContainer = document.querySelector(".restaurat-record-to-display");
  if(data) {
    productContainer.innerHTML = '';
    Object.values(data).map(item => {
      productContainer.innerHTML += `
      <!-- #1 restaurant -->
      <div class="row restaurant-record">
        <div class="col">
          <a href='${item.link}'>
          <img class="restaurant-img" src='${item.img}'>
          </a>
        </div>
        <div class="col-6 restaurant-name">
          <h1><a href='${item.link}'>${item.name}</a></h1>
          <h4 class="type">${item.type}</h4>
          <p>${item.desc}</p>
        </div>
        <div class="col details">
          <h3> Dostawa <span class ="supply">${item.delivery}</span> zł </h3>
          <h3> Minimalne zamówienie <span>${item.minimalOrderValue}</span>zł</h3>
          <h3> Opinie klientów <span class ="opinion">${item.clientsOpinion}</span>/5</h3>
        </div>
      </div>
      <hr class="solid">`;
    });
}
  }

function checkIfAny(data){
  let productContainer = document.querySelector(".restaurat-record-to-display");
  if (data.length == 0) {
    productContainer.innerHTML += `
    <div class="row restaurant-record not-found">
  <h1 style="text-align:center;">Przykro nam, brak restauracji spełniających wybrane kryteria w Twojej okolicy</h1>
    </div>
    <hr class="solid">`;
  }
}



  function deleteItemsFromLS (){
    localStorage.removeItem('productsInCart');
    localStorage.setItem('totalCost', 0);
    localStorage.setItem('cartNumbers',0);
  }
